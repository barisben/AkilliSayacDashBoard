@{
    ViewData["Title"] = "Malware Analysis";
}

<section class="section dashboard">
    <div class="row">

        <div class="col-lg-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Indicators by iTypes</h5>

                    <!-- Donut Chart -->
                    <div id="donutChart" style="min-height: 400px;" class="echart"></div>

                    <script>
                        document.addEventListener("DOMContentLoaded", () => {
                            echarts.init(document.querySelector("#donutChart")).setOption({
                                tooltip: {
                                    trigger: 'item',
                                    formatter: '{c} ({d}%)'
                                },
                                legend: {
                                    top: '0%',
                                    left: 'center'
                                },
                                series: [{
                                    name: 'Count',
                                    type: 'pie',
                                    radius: ['40%', '70%'],
                                    avoidLabelOverlap: false,
                                    label: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        label: {
                                            show: true,
                                            fontSize: '14',
                                            fontWeight: 'bold'
                                        }
                                    },
                                    labelLine: {
                                        show: false
                                    },
                                    data: [{
                                        value: 96.29,
                                        name: 'Malware File Hash'
                                    },
                                    {
                                        value: 1.87,
                                        name: 'Malware URL'
                                    },
                                    {
                                        value: 0.58,
                                        name: 'Malware Domain'
                                    },
                                    {
                                        value: 0.36,
                                        name: 'Infected Bot IP'
                                    },
                                    {
                                        value: 0.11,
                                        name: 'Malware SSDeep Hash'
                                    }
                                    ]
                                }]
                            });
                        });
                    </script>
                    <!-- End Donut Chart -->

                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Indicators by Origin Country</h5>

                    <!-- Pie Chart -->
                    <div id="pieChart" style="min-height: 400px;" class="echart"></div>

                    <script>
                        document.addEventListener("DOMContentLoaded", () => {
                            echarts.init(document.querySelector("#pieChart")).setOption({
                                tooltip: {
                                    trigger: 'item'
                                },
                                legend: {
                                    show: false
                                },
                                series: [{
                                    name: 'Count',
                                    type: 'pie',
                                    radius: '50%',
                                    label: {
                                        formatter: function (params) {
                                            return params.name + ' (' + params.percent + '%)';
                                        }
                                    },
                                    data: [{
                                        value: 2.54,
                                        name: 'JP'
                                    },
                                    {
                                        value: 4.17,
                                        name: 'DE'
                                    },
                                    {
                                        value: 2.03,
                                        name: 'TR'
                                    },
                                    {
                                        value: 28.15,
                                        name: 'US'
                                    },
                                    {
                                        value: 2.23,
                                        name: 'SG'
                                    },
                                    {
                                        value: 7.35,
                                        name: 'RU'
                                    },
                                    {
                                        value: 1.95,
                                        name: 'FR'
                                    },
                                    {
                                        value: 7.58,
                                        name: 'NL'
                                    },
                                    {
                                        value: 37.79,
                                        name: 'CN'
                                    },
                                    {
                                        value: 6.25,
                                        name: 'HK'
                                    }
                                    ],
                                    emphasis: {
                                        itemStyle: {
                                            shadowBlur: 10,
                                            shadowOffsetX: 0,
                                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                                        }
                                    }
                                }]
                            });
                        });
                    </script>
                    <!-- End Pie Chart -->

                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="row">

                <div class="card">

                    <div class="card-body">
                        <h5 class="card-title">Indicators by Source</h5>

                        <!-- Bar Chart -->
                        <div id="barChart"></div>

                        <script>
                            document.addEventListener("DOMContentLoaded", () => {
                                new ApexCharts(document.querySelector("#barChart"), {
                                    series: [{
                                        data: [2859, 141306, 2000, 112515, 75028, 3617, 14116, 229389, 4000]
                                    }],
                                    chart: {
                                        type: 'bar'
                                    },
                                    plotOptions: {
                                        bar: {
                                            borderRadius: 4,
                                            vertical: true,
                                        }
                                    },
                                    dataLabels: {
                                        enabled: false
                                    },
                                    xaxis: {
                                        categories: ['Blueliv Bot IPs', 'Blueliv Malware Hashes', 'iDefense', 'ThreatGRID', 'Intel471 Malware Intelligence', 'Malware Bazaar Database', 'Deloitte IOC Feed', 'CrowdStrike Falcon X', 'ThreatFox OSINT'
                                        ],
                                    },
                                    dataLabels: {
                                        enabled: true,
                                        formatter: function (val) {
                                            return val;
                                        },
                                        offsetY: 25,
                                        style: {
                                            fontSize: '12px',
                                            colors: ["#304758"]
                                        }
                                    }
                                }).render();
                            });
                        </script>
                        <!-- End Bar Chart -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>